import{j as s,c as j,k as N,o as y,n as S,u as A,r as x}from"./vendor-e59bfd4a.js";import{u as f,C as R,g as P,F as b,o as T,_ as W,k as L,B as d,y as I,h as F,e as V,r as D,i as _,D as E,I as B,j as K}from"./index-51b49a5b.js";import{P as $}from"./PageHeader-7c95fa6a.js";import{G as v,c as H}from"./Overview.module-f8d3e44b.js";import{c as o}from"./Applications.module-d9c8da72.js";import{A as G}from"./AvatarWithTitle-10cf263d.js";const O="_root_jfl1u_1",M="_white_jfl1u_9",U="_neutral_jfl1u_12",q="_primary_jfl1u_15",J="_success_jfl1u_18",Q="_warning_jfl1u_21",X="_danger_jfl1u_24",w={root:O,white:M,neutral:U,primary:q,success:J,warning:Q,danger:X},h=({color:a="primary",className:e})=>s.jsx("div",{className:j(w.root,w[a],e)}),k=({title:a,subtitle:e,src:u,icon:r,openUrl:p,status:n,path:i,className:g})=>{const{globalStore:c}=f();return s.jsx(R,{className:j(o.appsWidget,g),children:s.jsxs(N,{to:i,children:[s.jsx(G,{src:u,icon:r,title:a,subtitle:e,className:o.latestNews,classes:{subtitle:o.subtitle,avatar:o.avatar},onCLick:p}),n&&s.jsxs(s.Fragment,{children:[c.countStatuses(n,"Running")?s.jsx(h,{color:"success",className:o.statusPoint}):null,c.countStatuses(n,"Stopped")?s.jsx(h,{color:"warning",className:o.statusPoint}):null,c.countStatuses(n,"Error")?s.jsx(h,{color:"danger",className:o.statusPoint}):null]})]})})},Y="_spinner_c8922_1",Z="_spinnerLabel_c8922_6",z="_label_c8922_11",m={spinner:Y,spinnerLabel:Z,label:z},ss="_circularProgress_8yk2h_1",es="_progressRing_8yk2h_8",ts="_progressLabel_8yk2h_12",C={circularProgress:ss,progressRing:es,progressLabel:ts},as=({value:a,size:e,color:u,stroke:r=1,stroke2:p=2})=>{const n=(e-10)/2,i=2*Math.PI*n,g=i-a/100*i;return s.jsx("div",{style:{width:e,height:e},children:s.jsxs("svg",{className:C.progressRing,width:e,height:e,children:[s.jsx("circle",{cx:e/2,cy:e/2,r:n,strokeWidth:r,fill:"none",stroke:"#E5E5E6"}),s.jsx("circle",{className:C.progressRingCircle,stroke:u||"#0099cf",strokeWidth:p,fill:"transparent",r:n,cx:e/2,cy:e/2,style:{strokeDasharray:i,strokeDashoffset:g},transform:`rotate(0 ${e/2} ${e/2})`})]})})},rs=y(({onClick:a,onClickBtn:e,className:u,isInProgress:r,progress:p,spinner:n,dataTest:i})=>{const{globalStore:g}=f(),{isAutoRefreshActive:c,autoRefreshProgress:t}=g,l=()=>s.jsx(s.Fragment,{children:r&&p&&Number(p)>0?s.jsx(as,{value:p,size:26,color:"#fff",stroke:1,stroke2:3}):n?s.jsx(T,{size:20,color:"white",className:m.spinner}):null});return s.jsx(P,{className:j(m.autoRefresh,u),icon:c?"replay_5":"timer_pause",active:c,onClick:a,onClickBtn:e,btnProgress:c?100-Number(t):0,btnIsReloading:r,btnReloadComponent:l(),tip:c?"Auto refresh is active":"Auto refresh is paused",dataTest:i,children:s.jsx(b,{alignItems:"center",children:s.jsxs("span",{className:m.label,children:[" ",r?"Loading...":"Refresh"]})})})}),us=y(()=>{var c;const{configStore:a,globalStore:e}=f(),u=S(),{t:r}=A(),p=t=>{u("apps"+t.rowData.path)},n=t=>{u(t)},i=x.useCallback(W(t=>e.loadPaths(t),600),[]),g=()=>{e.isAutoRefreshActive&&e.stopAutoReload(),e.loadPaths()};return L(r("routes.apps")),x.useEffect(()=>{e.updateApp(),e.loadInfo(),e.toggleAddApp&&e.setToggleAddApp(!1)},[]),s.jsxs(s.Fragment,{children:[s.jsx(k,{className:o.serverWidth,icon:"dns",title:r("config.type",{type:"Server"}),path:"/overview/server-config"}),s.jsxs(b,{justifyContent:"space-between",alignItems:"center",children:[s.jsx($,{title:r("routes.apps")}),s.jsxs(b,{spacing:2,children:[s.jsx(rs,{spinner:e.loading,isInProgress:e.isInProgress||e.loading,progress:e.reloadProgress,onClick:g,onClickBtn:()=>e.toggleAutoReload(),className:o.refresh}),s.jsx(d,{icon:"apps",color:a.appView==="grid"?"blue":"neutral",onClick:()=>a.setAppView("grid")}),s.jsx(d,{icon:"list",color:a.appView==="table"?"blue":"neutral",onClick:()=>a.setAppView("table")}),!a.filterToggle&&s.jsx(d,{color:"neutral",icon:"search",onClick:()=>a.setFilterToggle()}),a.filterToggle&&s.jsx(I,{value:e.searchTerm,onChange:t=>{e.setSearchTerm(t.target.value),i(!0)},onClose:()=>a.setFilterToggle()})]})]}),s.jsxs("div",{className:F.wTabContent,children:[a.appView==="grid"&&s.jsx(v,{container:!0,spacing:"sm",children:(c=e.paths)==null?void 0:c.map(t=>s.jsx(v,{item:!0,xs:12,sm:6,md:4,lg:3,children:s.jsx(k,{status:t.status,src:V+t.path+"/rest/appicon",title:t.name,subtitle:t.path,path:"/apps"+t.path})},t.path))}),a.appView==="table"&&s.jsx("div",{className:H.table,children:s.jsx(D,{columns:[{dataKey:"name",width:35,align:"start",label:"",className:_.actionCell,component:(t,l)=>s.jsx(E,{className:_.actionCellDropdown,buttons:[{label:r("Config"),icon:"list_alt",onClick:()=>n("apps"+l.path)},{label:r("Sessions"),icon:"groups",onClick:()=>n("sessions"+l.path)}],children:s.jsx(B,{name:"more_vert"})})},{label:r("apps.name"),dataKey:"name",minWidth:100,align:"start",bSort:!0,component:(t,l)=>s.jsx(N,{className:o.cell,to:"/apps"+l.path,children:t})},{label:r("apps.path"),dataKey:"path",minWidth:100,align:"start",bSort:!0,component:(t,l)=>s.jsx("a",{className:o.cell,href:l==null?void 0:l.url,target:"_blank",rel:"noreferrer",children:t})},{label:r("apps.running"),dataKey:"runningInstances",minWidth:100,align:"start",bSort:!0},{label:r("general.status"),dataKey:"status",minWidth:100,align:"start",component:t=>s.jsx(K,{status:t})}],minTableWidth:435,rowHeight:60,threshold:500,rowClassName:o.ac,onRowDoubleClick:p,collection:e.paths,className:o.tableHeight,onSort:({key:t,direction:l})=>{e.setOrder(t,l),i(!0)}})})]})]})});export{us as default};
