import{o as T,r as c,u as B,j as e,c as O,n as V,E as X,a as Y}from"./vendor-e59bfd4a.js";import{u as A,B as C,V as Z,I as ee,C as se,F as w,e as W,j as ae,d as z,X as P,Y as K,m as ne,Z as Q,k as le,P as te,g as q,J as U,$ as oe,N as re}from"./index-51b49a5b.js";import{C as $}from"./ConfigUI-1a86fda2.js";import{c as u}from"./Applications.module-d9c8da72.js";import{A as ie}from"./AvatarWithTitle-10cf263d.js";import"./Config-072d6dfc.js";const G=T(({children:p,icon:s,onClick:d,name:l,active:a})=>{const[r,f]=c.useState(!1),{configStore:o}=A(),{t:g}=B(),j=()=>{const b=r?g("unsaved"):" ";return l==="webConfig"?o.wcChanged?b:"":o.acChanged?b:""};return e.jsxs(C.UI,{className:O(u.appTab,{[u.active]:a}),dataTest:l,children:[e.jsx(Z,{bOnBadge:!0,className:O(u.changesTracking),vertical:"top",side:"left",color:"danger",size:"small",onHover:()=>f(!r),content:j(),onClick:d,children:e.jsx(ee,{className:u.appTabIcon,name:s,onClick:d})}),p]})}),ce="_root_11cg0_1",ge="_AvatarCol_11cg0_5",de="_smCol_11cg0_9",fe="_label_11cg0_15",k={root:ce,AvatarCol:ge,smCol:de,label:fe},ue=T(function({app:s,className:d,onClick:l}){var I,t;const{permissionsStore:a,globalStore:r}=A(),f=r.info,[o,g]=c.useState(""),[j,b]=c.useState(!1),[v,n]=c.useState(!1),[h,F]=c.useState(!1),[N,m]=c.useState(!1),S=V(),{t:x}=B(),R=()=>{f.runningInstances!==0?F(!0):D()},y=i=>{r.loadInfo(i).then(()=>{var _,H;g(""),r.clearInterval(),b((_=r.info)==null?void 0:_.enabled),n(!((H=r.info)!=null&&H.enabled))}).then(()=>{r.setInterval(()=>{g(""),y(i)},5e3)}).catch(()=>{r.clearInterval()})},M=i=>{F(i)},L=()=>{g("Requesting Start"),b(!1),n(!1),P.start(s||"").then(()=>{y(s),K(x("ok.successStartApp"))})},D=()=>{g("Requesting Stop"),b(!1),n(!1),P.stop(s||"").then(()=>{y(s),K(x("ok.successStopApp")),h&&F(!1)})},E=()=>{g("Uninstalling app"),b(!1),n(!1),P.remove(s).then(()=>{r.removePath(s),K(x("ok.successRemoveApp")),n(!0),S("/apps")})};return c.useEffect(()=>(g(""),y(s),()=>r.clearInterval()),[s]),e.jsxs(se,{className:O(k.root,d),onClick:l,children:[e.jsxs(w,{style:{padding:"0 1rem"},children:[e.jsx(w,{bColumn:!0,className:k.AvatarCol,flex:2,children:e.jsx(ie,{size:"medium",src:W+"/"+s+"/rest/appicon",title:f==null?void 0:f.name,className:k.manageApp})}),e.jsxs(w,{bColumn:!0,flex:1,className:k.smCol,justifyContent:"center",children:[e.jsxs("span",{className:k.label,children:[x("general.status"),":"]}),e.jsx(ae,{status:(I=r.info)==null?void 0:I.status,loadMessage:o})]}),e.jsxs(w,{bColumn:!0,flex:1,className:k.smCol,justifyContent:"center",children:[e.jsxs("span",{className:k.label,children:[x("apps.path"),":"]}),e.jsx("a",{href:f==null?void 0:f.url,target:"_blank",rel:"noreferrer",children:f==null?void 0:f.path})]}),e.jsxs(w,{flex:2,justifyContent:"flex-end",alignItems:"center",children:[j&&a.get("stop")&&e.jsx(C,{color:"danger",size:"small",label:x("apps.disable"),onClick:R}),v&&a.get("start")&&e.jsx(C,{label:x("apps.enable"),size:"small",style:{marginRight:"6px"},onClick:L}),v&&a.get("remove")&&e.jsx(C,{color:"danger",size:"small",label:x("apps.remove"),onClick:()=>m(i=>!i)})]})]}),e.jsx(z,{bOpen:h,title:x("sessions.warning"),footer:!0,onToggle:M,onConfirm:D,children:x("apps.runningInstanceKillQCount",{count:(t=r.info)==null?void 0:t.runningInstances})}),e.jsx(z,{bOpen:N,title:x("apps.remove")+" "+s,footer:!0,onToggle:i=>m(i),onConfirm:E,children:x("apps.AreuSureRemove",{app:s})})]})}),J=T(({bLast:p,item:s,onClick:d,dataTest:l})=>{const{configStore:a}=A();return e.jsx("li",{className:O({[u.fitem]:p}),children:e.jsx(ne,{className:u.popSwitch,position:"right",value:s.activeSP,onClick:()=>a.activeSpSwitch(s),dataTest:l,children:e.jsxs("span",{"data-test":l+"-span",onClick:()=>d(s.key),children:[s.key,s.wasEdited&&e.jsx(Q,{color:"danger",size:"small",className:u.coin,children:"  "})]})})},s.key)}),me=T(({isOpen:p,app:s,onToggle:d})=>{const{configStore:l}=A(),{t:a}=B(),[r,f]=c.useState(!1),[o,g]=c.useState(null),j=()=>{s&&(f(!0),l.createWebFolder(s).then(n=>{n!=null?(g(n.messages||[]),n.anySuccess&&l.loadConfig(s)):g(["Failed to create web folder!"])}).catch(n=>{console.error(n),g(["Failed to create web folder!"])}))},b=()=>{if(l.config!=null&&l.config.webConfig!=null&&l.config.webConfig.data!=null)return l.config.webConfig.data.webHomeDir},v=n=>{f(!1),g(null),d==null||d(!n)};return e.jsx(z,{bOpen:p,title:a("config.createWebFolder"),onToggle:v,footer:!1,children:e.jsxs("div",{className:"flex flex-col flex-grow",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:a("config.createWebFolder.message")}),e.jsxs("div",{className:"mt-4 font-bold",children:[b(),"/webroot"]}),e.jsx("div",{className:"mt-4",children:a("config.createWebFolder.message2")}),e.jsx("div",{className:"mt-2",dangerouslySetInnerHTML:{__html:a("config.createWebFolder.message3")}})]}),e.jsx("div",{className:"flex-grow",children:r&&e.jsx(e.Fragment,{children:o?e.jsx(e.Fragment,{children:o.map((n,h)=>e.jsx("div",{children:n},h))}):e.jsx("div",{children:a("config.createWebFolder.creating")})})}),e.jsxs("div",{className:"mt-6 self-center flex gap-2",children:[e.jsx(C,{color:"neutral",label:a("config.createWebFolder.button.close"),size:"small",onClick:()=>v(p)}),!r&&e.jsx(C,{color:"blue",label:a("config.createWebFolder.button.create"),size:"small",onClick:j})]})]})})}),pe="_link_piipc_1",he={link:pe},be=T(({isOpen:p,app:s,onToggle:d})=>{const{configStore:l}=A(),{t:a}=B(),[r,f]=c.useState(!1),[o,g]=c.useState(null),[j,b]=c.useState({url:"",version:""}),[v,n]=c.useState(null),h=()=>{s&&(f(!0),g(null),l.configureOracleForms(s,j.url,j.version).then(m=>{m!=null?(g(m),m.error==null&&l.loadConfig(s),n(m.error)):n("Failed to configure!")}).catch(m=>{console.error(m),n("Failed to configure!")}))},F=m=>b(S=>({...S,[m.target.name]:m.target.value})),N=m=>{f(!1),g(null),n(null),d==null||d(!m)};return e.jsx(z,{bOpen:p,title:a("config.configureOracleForms"),onToggle:N,footer:!1,children:e.jsxs("div",{className:"flex flex-col flex-grow max-w-full",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:a("config.configureOracleForms.message")}),e.jsx("div",{className:"mt-4 font-bold",children:a("config.configureOracleForms.url")}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{className:"w-full p-2",placeholder:a("config.configureOracleForms.url.placeholder"),name:"url",value:j.url,onChange:F})}),e.jsx("div",{className:"mt-4 font-bold",children:a("config.configureOracleForms.version")}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{className:"w-full p-2",placeholder:a("config.configureOracleForms.version.placeholder"),name:"version",value:j.version,onChange:F})}),e.jsx("div",{className:"mt-4",children:a("config.configureOracleForms.message2")})]}),e.jsx("div",{className:"flex-grow",children:r&&e.jsx(e.Fragment,{children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold",children:a("config.configureOracleForms.error")}),e.jsx("div",{className:"mt-4",children:v})]}):e.jsx(e.Fragment,{children:o==null?e.jsx(e.Fragment,{children:e.jsx("div",{children:a("config.configureOracleForms.updating")})}):e.jsxs(e.Fragment,{children:[o.librariesLinkId&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold text-danger",children:a("config.configureOracleForms.libs")}),e.jsx("div",{className:"mt-4",children:e.jsx("a",{className:he.link,href:W+"/"+s+"/rest/link/"+o.librariesLinkId,target:"_blank",rel:"noreferrer",children:a("config.configureOracleForms.libs.link")})})]}),(o.documentbase!=null||o.codebase!=null||o.params)&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-4",children:a("config.configureOracleForms.successNote")})}),o.mainClass!=null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4 font-bold",children:a("config.configureOracleForms.mainClass")}),e.jsx("div",{className:"mt-4",children:o.mainClass})]}),o.documentbase!=null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4 font-bold",children:a("config.configureOracleForms.documentBase")}),e.jsx("div",{className:"mt-4",children:o.documentbase})]}),o.codebase!=null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4 font-bold",children:a("config.configureOracleForms.codeBase")}),e.jsx("div",{className:"mt-4",children:o.codebase})]}),o.params&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4 font-bold",children:a("config.configureOracleForms.params")}),e.jsx("div",{className:"mt-4 max-h-40 overflow-auto",children:Object.entries(o.params).map(([m,S])=>e.jsxs("div",{children:[e.jsxs("span",{className:"whitespace-nowrap italic",children:[m," = "]}),e.jsx("span",{className:"whitespace-nowrap",children:S})]},m))})]})]})})})}),e.jsxs("div",{className:"mt-6 self-center flex gap-2",children:[e.jsx(C,{color:"neutral",label:a("config.configureOracleForms.button.close"),size:"small",onClick:()=>N(p)}),!r&&e.jsx(C,{color:"blue",label:a("config.configureOracleForms.button.update"),size:"small",onClick:h})]})]})})}),Se=T(()=>{var L,D,E,I;const{permissionsStore:p,configStore:s,globalStore:d}=A(),{app:l}=X(),[a,r]=c.useState(!1),[f,o]=c.useState(!1),[g,j]=c.useState(!1),[b,v]=c.useState(!1),{t:n,i18n:h}=B(),F=c.useCallback(()=>{var t;(t=d.info)!=null&&t.cluster?o(i=>!i):s.openTab(s.allOrOne)},[o]),N=c.useCallback(t=>{s.openTab(t),o(i=>!i)},[o]),m=()=>!d.isCluster||s.hasAllInactive||s.allOrOne==="allID"?n("config.appConfig"):`${n("config.appConfig")} (${s.allOrOne})`,S=t=>{(t.ctrlKey||t.metaKey)&&t.key==="s"&&(t.preventDefault(),s.setConfig(l))},x=()=>{if(s.config!=null&&s.config.webConfig!=null&&s.config.webConfig.data!=null){const t=s.config.webConfig.data.webFolder;if(t!=null&&t.trim().length>0)return t}},R=()=>{if(s.config==null||s.config.appConfig==null)return!1;for(const t in s.config.appConfig)if(s.config.appConfig[t].data==null||s.config.appConfig[t].data.launcherType!="OracleForms")return!1;return!0},y=()=>a&&s.config!=null&&p.get("configSwingEdit")&&x()==null,M=()=>a&&s.config!=null&&p.get("configSwingEdit")&&R();return c.useEffect(()=>(document.addEventListener("keydown",S),()=>{document.removeEventListener("keydown",S)}),[l]),c.useEffect(()=>()=>{s.clearConfigData()},[]),c.useEffect(()=>{r(!1),s.loadConfig(l).then(()=>{r(!0)}),d.updateApp(l),d.toggleAddApp&&d.setToggleAddApp(!1)},[l]),le(n("routes.appConfig")),l?e.jsxs(e.Fragment,{children:[e.jsx(ue,{app:l}),e.jsxs(w,{className:u.headerRow,justifyContent:"space-between",alignItems:"center",children:[e.jsxs(w,{className:u.stickyBtnGroup,children:[e.jsx(G,{name:"webConfig",icon:"web",onClick:()=>s.openTab("webConfig"),active:s.activeTab==="webConfig",children:e.jsx("div",{className:u.appTabText,onClick:()=>s.openTab("webConfig"),"data-test":"webConfigTabText",children:n("config.webConfig")})}),e.jsxs(G,{name:"appConfig",icon:"av_timer",onClick:F,active:s.activeTab==="allID"||s.isTab(),children:[e.jsx("div",{className:u.appTabText,onClick:()=>s.openTab(s.allOrOne),"data-test":"appConfigTabText",children:m()}),e.jsx(te,{backdrop:!0,className:O(u.popover),open:f,side:"left",onBlur:F,children:e.jsxs("ul",{className:u.popList,children:[!s.hideALL&&e.jsxs("li",{"data-test":"allSessionConfig",className:u.fitem,onClick:()=>N("allID"),children:[n("config.allSessionConfig"),s.allConfigWasEdited&&e.jsx(Q,{color:"danger",size:"small",className:u.coin,children:"  "})]}),!s.hasAllInactive&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:u.appLabel,children:[n("config.activeSP"),":"]}),s.activeTabs.map((t,i)=>e.jsx(J,{bLast:s.activeTabs.length===i+1,item:t,dataTest:"sp-active"+i+1,onClick:()=>N(t.key)},t.key))]}),!s.hasAllActive&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:u.appLabel,children:[n("config.inactiveSP"),":"]}),s.inactiveTabs.map((t,i)=>e.jsx(J,{bLast:s.inactiveTabs.length===i+1,item:t,dataTest:"sp-inactive"+i+1,onClick:()=>N(t.key)},t.key))]})]})})]})]}),e.jsxs(w,{children:[y()&&e.jsx(q,{bDisabled:s.activeApply,className:"m-1",tip:s.activeApply?n("config.createWebFolder.disabled"):void 0,icon:"create_new_folder",onClick:()=>j(!g),children:n("config.createWebFolder")}),M()&&e.jsx(q,{bDisabled:s.activeApply,className:"m-1",tip:s.activeApply?n("config.configureOracleForms.disabled"):void 0,icon:"create_new_folder",onClick:()=>v(!b),children:n("config.configureOracleForms")})]})]}),e.jsxs("div",{className:O(u.appTabContent),children:[s.activeTab==="webConfig"&&e.jsx($,{readonly:!p.get("configSwingEdit"),identify:l,path:U(W,l),value:(L=s.config)==null?void 0:L.webConfig,hide:oe,translations:(D=h.getDataByLanguage(h.language))==null?void 0:D.translation,lang:h.language}),s.activeTab==="allID"&&!s.hideALL&&e.jsx($,{readonly:!p.get("configSwingEdit"),identify:"allID",path:U(W,l),list:(E=s.config)==null?void 0:E.appConfig,translations:(I=h.getDataByLanguage(h.language))==null?void 0:I.translation,lang:h.language}),s.tabs.map(t=>{var i,_;return e.jsx(Y.Fragment,{children:s.isTab(t.key)&&e.jsx($,{readonly:!p.get("configSwingEdit"),identify:t.key,path:U(W,l),value:(i=s.config)==null?void 0:i.appConfig[t.key],istab:!0,translations:(_=h.getDataByLanguage(h.language))==null?void 0:_.translation,lang:h.language})},t.key)}),s.hasAllInactive&&s.activeTab!=="webConfig"&&e.jsx(re,{message:n("apps.noActiveSps"),children:e.jsx(C,{icon:"refresh",color:"neutral",onClick:()=>s.loadConfig(l)})})]}),e.jsx(C.Group,{className:O(u.floatingButtons,{[u.activeApply]:s.activeApply}),buttons:[{label:n("general.apply"),size:"small",color:"blue",bDisabled:s.isActionInProgress,onClick:()=>s.setConfig(l)},{label:n("general.reset"),size:"small",color:"white",onClick:()=>s.resetConfig(l)}]}),e.jsx(me,{isOpen:g,app:l,onToggle:()=>j(!g)}),e.jsx(be,{isOpen:b,app:l,onToggle:()=>v(!b)})]}):e.jsx(e.Fragment,{})});export{Se as default};
